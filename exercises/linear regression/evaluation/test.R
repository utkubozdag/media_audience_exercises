context({
  testcase("Linear regression model", {
    testEqual("simple_model exists and is an lm object",
              function(env) { inherits(env$simple_model, "lm") },
              TRUE)

    testEqual("Model uses the correct predictor variable",
              function(env) {
                as.character(formula(env$simple_model))[3] == "Perceived_Majority_Support_pct"
              },
              TRUE)

    testEqual("Model uses the correct response variable",
              function(env) {
                as.character(formula(env$simple_model))[2] == "Willingness_To_Speak_1_5"
              },
              TRUE)

    testEqual("Model has intercept and slope coefficients",
              function(env) { length(coef(env$simple_model)) },
              2)
  })
}, preExec = {
  data <- data.frame(
    Perceived_Majority_Support_pct = c(79.7, 62.4, 66.4, 84.9, 50.1, 52.8, 36.1, 40.1, 63.2, 79.3, 22.7, 56.6, 54.6, 61, 65.4, 36.5, 59.9, 50.8, 70.9, 49.6, 66.5, 43.4, 55.1, 26, 40.6, 32.6, 85.7, 51.2, 82.7, 28.4, 58, 70.8, 24.5, 40.3, 68.6, 71.7, 48.4, 47.9, 59.9, 84.4, 68.1, 63.9, 32, 40.5, 76.4, 67.3, 18.6, 47.7, 57.6, 80.2, 19.9, 64.1, 86.6, 82.8, 36.5, 50.1, 70.9, 37.6, 73.7, 47, 69.9, 17.7, 56.4, 87.8, 27.2, 74.1, 34.7, 38.9, 71, 64.7, 80.9, 39.2, 68.6, 52.3, 80.4, 70.1, 7.6, 41.6, 49.7, 71.6, 53.1, 51.8, 47.6, 69.7, 96.3, 52.7, 54.3, 49.7, 82.6, 33.8, 66.6, 72.8, 28.3, 25.6, 73.9, 51, 76.3, 34.4, 29.3, 29.5, 48.7, 24.8, 66.2, 54.5, 15.9, 53.8, 53.4, 87.5, 63.6, 46.6, 52.6, 81.9, 77.5, 20.9, 60.9, 80.5, 51.6, 80.1, 75.8, 19.8, 51.4, 66.2, 44.1, 32, 40.2, 24.2, 26.5, 46.2, 42.5, 38, 58, 44.9, 17.9, 24.6, 43.5, 52.5, 32.6, 53.3, 60.5, 86.9, 60.4, 33.8, 12.8, 59.7, 77.7, 60.8, 46.7, 52.5, 60.2, 57.2, 47.5, 58.9, 37.5, 63.6, 90.8, 91.9, 53.9, 47.2, 72.3, 42.6, 26.7, 49.8, 57.1, 27.7, 67.2, 41.8, 22.7, 42.4, 81.6, 81.5, 74, 62.2, 67.5, 59, 63.7, 31.9, 81.6, 49.2, 72.7, 23.9, 52.7, 46.4, 75.3, 76.5, 39.3, 75.4, 60.9, 58.2, 75.2, 35.1, 37.2, 60, 60, 54.3, 47.5, 47.3, 28.1, 22.1, 27.1, 82.8),
    Willingness_To_Speak_1_5 = c(4, 2, 4, 5, 3, 4, 1, 2, 3, 5, 2, 3, 4, 4, 5, 2, 4, 5, 5, 4, 5, 3, 3, 1, 2, 1, 3, 4, 5, 4, 5, 5, 1, 3, 5, 4, 3, 3, 4, 4, 4, 5, 4, 3, 5, 5, 3, 3, 3, 5, 1, 5, 5, 4, 2, 3, 5, 3, 4, 3, 5, 1, 5, 5, 2, 4, 1, 2, 5, 4, 4, 2, 3, 3, 5, 5, 1, 3, 3, 5, 2, 4, 3, 5, 5, 1, 1, 4, 5, 3, 4, 4, 1, 1, 3, 3, 5, 3, 3, 3, 1, 1, 4, 2, 2, 3, 3, 5, 3, 3, 5, 5, 5, 3, 3, 5, 2, 5, 4, 3, 4, 4, 1, 3, 2, 2, 3, 2, 2, 3, 4, 3, 1, 1, 3, 2, 1, 5, 4, 5, 2, 1, 1, 2, 5, 2, 3, 3, 5, 4, 3, 5, 4, 5, 5, 5, 3, 2, 4, 3, 1, 4, 3, 3, 3, 2, 1, 1, 5, 5, 5, 3, 5, 3, 5, 1, 5, 4, 5, 1, 2, 3, 3, 5, 2, 4, 4, 2, 3, 3, 2, 3, 4, 4, 4, 2, 1, 2, 2, 5)
  )
})
